const logger = require('../util/logger');

module.exports.customEmail = function (event, context) {
  logger.info({ message: 'EVENT', event });
  if (event.triggerSource === 'CustomMessage_SignUp') {
    event.response.emailSubject = 'Welcome to timplus';
    //customize verification email below
    event.response.emailMessage = `
    Customized verification code is ${event.request.codeParameter}
    `;
    //<a target='_blank' href="${event.request.userAttributes['custom:url']}/login?authcode=${event.request.codeParameter}&user=${event.userName}&orgId=${event.request.userAttributes['custom:orgId']}&userId=${event.request.userAttributes['custom:userId']}&type=${event.request.userAttributes['custom:type']}&email=${event.request.userAttributes.email}" class=' link2' style='color: #ffffff !important;
  } else if (event.triggerSource === 'CustomMessage_ForgotPassword') {
    logger.info({ message: 'email works' });
    event.response.emailSubject = 'Forgot Password - ';
    event.response.emailMessage = `
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> <title>[SUBJECT]</title> <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"> <style>body{padding-top: 0 !important; padding-bottom: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; margin: 0 !important; width: 100% !important; -webkit-text-size-adjust: 100% !important; -ms-text-size-adjust: 100% !important; -webkit-font-smoothing: antialiased !important; font-family: 'Montserrat', sans-serif; background-color: white;}.tableContent img{border: 0 !important; display: block !important; outline: none !important;}a{color: #382F2E;}p, h1, h2, ul, ol, li, div{margin: 0; padding: 0;}h1, h2{font-weight: normal; background: transparent !important; border: none !important; font-family: 'Montserrat', sans-serif;}@media only screen and (max-width:480px){table[class="MainContainer"], td[class="cell"]{width: 100% !important; height: auto !important;}td[class="specbundle"]{width: 100% !important; float: left !important; font-size: 13px !important; line-height: 17px !important; display: block !important; padding-bottom: 15px !important;}td[class="specbundle2"]{width: 80% !important; float: left !important; font-size: 13px !important; line-height: 17px !important; display: block !important; padding-bottom: 10px !important; padding-left: 10% !important; padding-right: 10% !important;}td[class="spechide"]{display: none !important;}img[class="banner"]{width: 100% !important; height: auto !important;}td[class="left_pad"]{padding-left: 15px !important; padding-right: 15px !important;}}@media only screen and (max-width:540px){table[class="MainContainer"], td[class="cell"]{width: 100% !important; height: auto !important;}td[class="specbundle"]{width: 100% !important; float: left !important; font-size: 13px !important; line-height: 17px !important; display: block !important; padding-bottom: 15px !important;}td[class="specbundle2"]{width: 80% !important; float: left !important; font-size: 13px !important; line-height: 17px !important; display: block !important; padding-bottom: 10px !important; padding-left: 10% !important; padding-right: 10% !important;}td[class="spechide"]{display: none !important;}img[class="banner"]{width: 100% !important; height: auto !important;}td[class="left_pad"]{padding-left: 15px !important; padding-right: 15px !important;}}.contentEditable h2.big, .contentEditable h1.big{font-size: 26px !important;}.contentEditable h2.bigger, .contentEditable h1.bigger{font-size: 37px !important;}td, table{vertical-align: top;}td.middle{vertical-align: middle;}a.link1{font-size: 13px; color: #27A1E5; line-height: 24px; text-decoration: none;}a{text-decoration: none;}.link2{color: #ffffff; border-top: 10px solid #27A1E5; border-bottom: 10px solid #27A1E5; border-left: 18px solid #27A1E5; border-right: 18px solid #27A1E5; border-radius: 3px; -moz-border-radius: 3px; -webkit-border-radius: 3px; background: #27A1E5;}.link5{color: #ffffff; border-top: 10px solid #E2472B; border-bottom: 10px solid #E2472B; border-left: 18px solid #E2472B; border-right: 18px solid #E2472B; border-radius: 3px; padding: 7px 22px 7px 22px; min-width: 500px; -moz-border-radius: 3px; -webkit-border-radius: 3px; background: #E2472B;}.link3{color: #555555; border: 1px solid #cccccc; padding: 10px 18px; border-radius: 3px; -moz-border-radius: 3px; -webkit-border-radius: 3px; background: #ffffff;}.link4{color: #27A1E5; line-height: 24px;}h2, h1{line-height: 20px;}p{font-size: 14px; line-height: 21px; color: #AAAAAA;}.contentEditable li{}.appart p{}.bgItem{background: #ffffff;}.bgBody{background: #ffffff;}img{outline: none; text-decoration: none; -ms-interpolation-mode: bicubic; width: auto; max-width: 100%; clear: both; display: block; float: none;}.footer-image{margin: 0 auto; width: 99px;}</style> <script type="colorScheme" class="swatch active">{"name":"Default", "bgBody":"ffffff", "link":"27A1E5", "color":"AAAAAA", "bgItem":"ffffff", "title":"444444"}</script><!-- [if mso]> <style>body, span, td, table, div{font-family: Arial, serif !important;}</style><![endif] --> </head> <body paddingwidth="0" paddingheight="0" bgcolor="#d1d3d4" style="padding-top: 0; padding-bottom: 0; padding-top: 0; padding-bottom: 0; background-repeat: repeat; width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; -webkit-font-smoothing: antialiased; font-family: Arial, Helvetica, sans-serif !important;" offset="0" toppadding="0" leftpadding="0"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td> <table width="600" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#ffffff" style="font-family:helvetica, sans-serif;" class="MainContainer"> <tbody> <tr> <td> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td valign="top" width="20">&nbsp;</td><td> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td class="movableContentContainer"> <div class="movableContent" style="border: 0px; padding-top: 0px; position: relative; margin-top: 40px;"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td height="40"></td></tr><tr> <td valign="top" width="580"> <div class='contentEditableContainer contentImageEditable'> <div class='contentEditable' style="text-align: center;"> <img class="banner" src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/shield.png" alt="Logo" title="Logo" width="100%" height="auto" border="0" style="margin: 0 auto;"> </div></div></td></tr></tbody> </table> </div><div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td height='40'></td></tr><tr> <td> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td valign="top" width="40">&nbsp;</td><td> <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"> <tr> <td height='25'></td></tr><tr> <td> <div class='contentEditableContainer contentTextEditable'> <div class='contentEditable' style='text-align: center;'> <h2 style="font-size: 20px;">Hi ${event.request.userAttributes.name}</h2> <br><p>you recently requested to reset your password for your  account. Click the bellow button to reset it. <br><br><br><a target='_blank' href="${event.request.userAttributes['custom:url']}/change-password?username=${event.userName}&verificationCode=${event.request.codeParameter}" class='link5' style='color:#ffffff'> Reset Password </a> <br><br><br>If you did not request a password reset, please ignore this email or reply to let us know. </p><br><br><br></div></div></td></tr><tr> <td height='24'></td></tr><tr> <td> <hr style='height:1px;background:#DDDDDD;border:none;'> </td></tr></table> </td><td valign="top" width="40">&nbsp;</td></tr></tbody> </table> </td></tr></tbody> </table> </div><div class="movableContent" style="border: 0px; padding-top: 0px; position: relative;"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td height="40"></td></tr><tr> <td> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td valign="top" width="185" class="spechide">&nbsp;</td><td class="specbundle2"> <table width="100%" cellpadding="0" cellspacing="0" align="center"> <tr> <td width='40'> <div class='contentEditableContainer contentFacebookEditable'> <div class='contentEditable' style='text-align: center;color:#AAAAAA;'> <img src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/facebook.png" alt="facebook" width='40' height='40' data-max-width="40" data-customIcon="true" border="0"> </div></div></td><td width='10'></td><td width='40'> <div class='contentEditableContainer contentTwitterEditable'> <div class='contentEditable' style='text-align: center;color:#AAAAAA;'> <img src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/twitter.png" alt="twitter" width='40' height='40' data-max-width="40" data-customIcon="true" border="0"> </div></div></td><td width='10'></td><td width='40'> <div class='contentEditableContainer contentImageEditable'> <div class='contentEditable' style='text-align: center;color:#AAAAAA;'> <img src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/red.png" alt="Pinterest" width='40' height='40' data-max-width="40" border="0"> </div></div></td><td width='10'></td><td width='40'> <div class='contentEditableContainer contentImageEditable'> <div class='contentEditable' style='text-align: center;color:#AAAAAA;'> <img src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/blue.png" alt="Social media" width='40' height='40' data-max-width="40" border="0"> </div></div></td></tr></table> </td><td valign="top" width="185" class="spechide">&nbsp;</td></tr></tbody> </table> </td></tr><!-- <tr> <td height='40'></td></tr>--> </tbody> </table> </div></td></tr></tbody> </table> </td><td valign="top" width="20">&nbsp;</td></tr></tbody> </table> </td></tr></tbody> </table> </td></tr></tbody> </table> <br><br><div style="text-align: center;"> <a href="http://.com/"> <img class="footer-image" src="https://s3-us-west-2.amazonaws.com/-resources/forgotPassword/logo.png" alt="Logo" title="Logo" width="100%" height="auto" border="0"> </a> </div><br><br></body> </html>
    `;
  }
  logger.info({ message: 'end :', event });
  context.done(null, event);
};